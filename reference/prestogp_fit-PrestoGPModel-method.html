<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Train a PrestoGP model. — prestogp_fit,PrestoGPModel-method • PrestoGP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Train a PrestoGP model. — prestogp_fit,PrestoGPModel-method"><meta name="description" content="This method fits a PrestoGP model given a set of locations and predictor
and outcome variables."><meta property="og:description" content="This method fits a PrestoGP model given a set of locations and predictor
and outcome variables."><meta property="og:image" content="https://niehs.github.io/PrestoGP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PrestoGP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9045</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/NIEHS/PrestoGP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Train a PrestoGP model.</h1>
      <small class="dont-index">Source: <a href="https://github.com/NIEHS/PrestoGP/blob/main/R/PrestoGP_Model.R" class="external-link"><code>R/PrestoGP_Model.R</code></a></small>
      <div class="d-none name"><code>prestogp_fit-PrestoGPModel-method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method fits a PrestoGP model given a set of locations and predictor
and outcome variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'PrestoGPModel'</span></span>
<span><span class="fu">prestogp_fit</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">locs</span>,</span>
<span>  Y.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaling <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  common_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covparams <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta.hat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.999999</span>,</span>
<span>  max_iters <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  center.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  impute.y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optim.method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span>
<span>  optim.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">0</span>, reltol <span class="op">=</span> <span class="fl">0.001</span>, maxit <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lasso"</span>, <span class="st">"relaxed"</span>, <span class="st">"MCP"</span>, <span class="st">"SCAD"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span><span class="op">)</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  foldid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>The PrestoGP model object being fit.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The values of the response variable(s). Should be a matrix or
vector for univariate models or a list for multivariate models.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The values of the predictor variable(s). Should be a matrix for
univariate models or a list for multivariate models.</p></dd>


<dt id="arg-locs">locs<a class="anchor" aria-label="anchor" href="#arg-locs"></a></dt>
<dd><p>The values of the locations. Should be a matrix for univariate
models or a list for multivariate models.</p></dd>


<dt id="arg-y-names">Y.names<a class="anchor" aria-label="anchor" href="#arg-y-names"></a></dt>
<dd><p>The name(s) for the response variable(s). Should be a vector
with length equal to the number of response variables. Defaults to NULL.</p></dd>


<dt id="arg-x-names">X.names<a class="anchor" aria-label="anchor" href="#arg-x-names"></a></dt>
<dd><p>The names for the predictor variables. Should be a vector
for univariate models or a list for multivariate models.</p></dd>


<dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>A vector of consecutive positive integers that is used to
specify which columns of locs should have the same scaling parameter. For
example, in a spatiotemporal model with two spatial measures and a time
measure, the value of scaling would be c(1, 1, 2). The length of scaling
must match the number of columns of locs. If it is not specified, all
columns of locs will have a common scale parameter.</p></dd>


<dt id="arg-common-scale">common_scale<a class="anchor" aria-label="anchor" href="#arg-common-scale"></a></dt>
<dd><p>Do all columsn of locs have a common scales parameter?
See Details for the effects of this parameter. Defaults to TRUE if there
is only one scale parameter for each outcome and FALSE otherwise.</p></dd>


<dt id="arg-covparams">covparams<a class="anchor" aria-label="anchor" href="#arg-covparams"></a></dt>
<dd><p>The initial covariance parameters estimate (optional).</p></dd>


<dt id="arg-beta-hat">beta.hat<a class="anchor" aria-label="anchor" href="#arg-beta-hat"></a></dt>
<dd><p>The initial beta parameters estimates (optional).</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>The model is considered converged when error is not less than
tol*previous_error (optional). Defaults to 0.999999.</p></dd>


<dt id="arg-max-iters">max_iters<a class="anchor" aria-label="anchor" href="#arg-max-iters"></a></dt>
<dd><p>Maximum number of iterations for the model fitting
procedure. Defaults to 100.</p></dd>


<dt id="arg-center-y">center.y<a class="anchor" aria-label="anchor" href="#arg-center-y"></a></dt>
<dd><p>Should the Y's be mean centered before fitting the model?
Defaults to TRUE for gaussian models and FALSE for binomial models.</p></dd>


<dt id="arg-impute-y">impute.y<a class="anchor" aria-label="anchor" href="#arg-impute-y"></a></dt>
<dd><p>Should missing Y's be imputed? Defaults to FALSE.</p></dd>


<dt id="arg-lod">lod<a class="anchor" aria-label="anchor" href="#arg-lod"></a></dt>
<dd><p>Limit of detection value(s). Any Y value less than lod is
assumed to be missing when performing missing data imputation. Should be
numeric for univariate models and a list for multivariate models, where
each element of the list corresponds to an outcome. The ith element of
the lod is the limit of detection for observation i. Alternatively, one
can specify a single limit of detection that is assumed to be the same for
all observations. If not specified, it is assumed that no limit of
detection exists. Ignored if impute.y is FALSE.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If FALSE, the penalized log likelihood and the model MSE
will be printed for each iteration of the model fitting procedure. No
intermediate output will be printed if TRUE. Defaults to FALSE.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If TRUE, the estimated theta/beta parameters will be printed
for each iteration of the model fitting procedure. Defaults to FALSE.
Ignored if quiet is TRUE.</p></dd>


<dt id="arg-optim-method">optim.method<a class="anchor" aria-label="anchor" href="#arg-optim-method"></a></dt>
<dd><p>Optimization method to be used for the maximum
likelihood estimation that is passed to optim. Defaults to "Nelder-Mead".
See <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>


<dt id="arg-optim-control">optim.control<a class="anchor" aria-label="anchor" href="#arg-optim-control"></a></dt>
<dd><p>Control parameter that is passed to optim. See
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>The type of penalized regression to be used. Should be one
of "lasso", "relaxed", "MCP", or "SCAD". Note that "lasso" and "relaxed"
will fit the model using glmnet and "MCP" and "SCAD" will fit the model
using ncvreg. See <code><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></code> or
<code><a href="https://pbreheny.github.io/ncvreg/reference/ncvreg.html" class="external-link">ncvreg</a></code>. Defaults to "lasso".</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The elastic net mixing parameter. 'alpha=1' corresponds to
lasso (or SCAD/MCP) penalty; 'alpha=0' corresponds to ridge regression.
See <code><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></code> or <code><a href="https://pbreheny.github.io/ncvreg/reference/ncvreg.html" class="external-link">ncvreg</a></code>. Defaults
to 1.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Family parameter for the glmnet or ncvreg model. Currently
only "gaussian" and "binomial" are supported. Defaults to "gaussian". See
<code><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></code> or <code><a href="https://pbreheny.github.io/ncvreg/reference/ncvreg.html" class="external-link">ncvreg</a></code>.</p></dd>


<dt id="arg-nfolds">nfolds<a class="anchor" aria-label="anchor" href="#arg-nfolds"></a></dt>
<dd><p>Number of cross-validation folds for cv.glmnet. Defaults to
10. See <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code>.</p></dd>


<dt id="arg-foldid">foldid<a class="anchor" aria-label="anchor" href="#arg-foldid"></a></dt>
<dd><p>Optional vector of values between 1 and "nfolds" specifying
what fold each observation should be assigned to in the cv.glmnet
cross-validation. See <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code> and
<code><a href="https://pbreheny.github.io/ncvreg/reference/cv.ncvreg.html" class="external-link">cv.ncvreg</a></code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Should parallel "foreach" be used to speed up the model
fitting procedure where possible? Defaults to FALSE. Specifically,
parallelization will be used for imputation and fitting the cv.glmnet
object. See <code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code>. Note that this
only applies to glmnet models (where penalty="lasso" or
penalty="relaxed"). Models using ncvreg (where penalty="MCP" or
penalty="SCAD") require a cluster argument for parallelization (see below).</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>A cluster for running cv.ncvreg in parallel. See
<code><a href="https://pbreheny.github.io/ncvreg/reference/cv.ncvreg.html" class="external-link">cv.ncvreg</a></code> and <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code>.
This must be specified to run cv.ncvreg in parallel. It is ignored for
glmnet models.</p></dd>


<dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>Should adaptive lasso be used? Defaults to FALSE. It is
ignored for SCAD and MCP models.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A PrestoGPModel object with slots updated based on the results of
the model fitting procedure. See <code><a href="PrestoGPModel-class.html">PrestoGPModel-class</a></code> for
details.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If common_scale is TRUE, multivariate models will use the Matern
cross-covariance function described in Apanasovich et al. (2012). This
model can only be used if each outcome has only a single scale parameter.
If common_scale is FALSE, each column of locs will be divded by the
corresponding element of scaling, and the cross-covariance will be computed
under the assumption that all scale parameters are equal to 1. For
univariate models, the Vecchia approximation will not be recomputed in
each iteration of the model fitting procedure if common_scale is TRUE,
but the parameter is otherwise ignored.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Apanasovich, T.V., Genton, M.G. and Sun, Y. "A valid Matérn class of
cross-covariance functions for multivariate random fields with any number
of components", Journal of the American Statistical Association (2012)
107(497):180-193.</p></li>
<li><p>Messier, K.P. and Katzfuss, M. "Scalable penalized spatiotemporal
land-use regression for ground-level nitrogen dioxide", The Annals of
Applied Statistics (2021) 15(2):688-710.</p></li>
<li><p>Zou, H. "The adaptive lasso and its oracle properties", Journal of
the American Statistical Association (2006) 101(476):1418-1429.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PrestoGPModel-class.html">PrestoGPModel-class</a></code>, <code><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># remove rows with NA's</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>                   <span class="co"># predict moisture content</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vecchia model</span></span></span>
<span class="r-in"><span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 487.4431 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.104869 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.7969 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.059078 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.7969 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.040029 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Impute missing y's</span></span></span>
<span class="r-in"><span><span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.miss</span> <span class="op">&lt;-</span> <span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">y.miss</span><span class="op">[</span><span class="va">miss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span>, impute.y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 487.5908 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.104869 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 482.3302 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.034162 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.7161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.047537 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.682 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.053241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.682 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.051056 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Impute y's missing due to limit of detection</span></span></span>
<span class="r-in"><span><span class="va">soil.lod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.lod</span> <span class="op">&lt;-</span> <span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">y.lod</span><span class="op">[</span><span class="va">y.lod</span> <span class="op">&lt;=</span> <span class="va">soil.lod</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">soil.vm3</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.vm3</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span>, impute.y <span class="op">=</span> <span class="cn">TRUE</span>, lod <span class="op">=</span> <span class="va">soil.lod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 487.4709 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.104869 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 482.1701 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.041494 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 482.0226 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.039863 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.8539 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.052357 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.6124 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.0451 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 6 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.5866 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.047799 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 7 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.5866 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.047799 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Full model</span></span></span>
<span class="r-in"><span><span class="va">soil.fm</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"FullModel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.fm</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.fm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 487.537 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.104869 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 482.1801 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.093929 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.9328 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.078835 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.8612 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.084228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 481.8612 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 9.051509 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multivariate model</span></span></span>
<span class="r-in"><span><span class="va">ym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ym</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>             <span class="co"># predict two nitrogen concentration levels</span></span></span>
<span class="r-in"><span><span class="va">ym</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Xm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Xm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locsm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">locsm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">locs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">soil.mvm</span> <span class="op">&lt;-</span>  <span class="fu">new</span><span class="op">(</span><span class="st">"MultivariateVecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.mvm</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.mvm</span>, <span class="va">ym</span>, <span class="va">Xm</span>, <span class="va">locsm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 1292.736 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 45.75698 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 1292.448 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 228.6715 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 1287.651 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 240.076 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: 1287.651 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 258.4328 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Space/elevation model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil250</span>, package<span class="op">=</span><span class="st">"geoR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">soil250</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span>               <span class="co"># predict pH level</span></span></span>
<span class="r-in"><span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil250</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># columns 1+2 are location coordinates; column 3 is elevation</span></span></span>
<span class="r-in"><span><span class="va">locs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil250</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fit separate scale parameters for location and elevation</span></span></span>
<span class="r-in"><span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">prestogp_fit</span><span class="op">(</span><span class="va">soil.vm2</span>, <span class="va">y2</span>, <span class="va">X2</span>, <span class="va">locs2</span>, scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating initial beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of initial beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: -259.0475 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 0.008204926 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning iteration 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating theta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of theta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating beta... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of beta complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current penalized negative log likelihood: -259.0475 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Current MSE: 0.009570522 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Bair, Brian Kidd, Eric Wimberley, Deepak Mav, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

