<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="After fitting a PrestoGP model, this method can be used to make predictions
on an independent test set (consisting of both new locations and new values
of the predictor variables)."><title>Prediction for PrestoGP models — prestogp_predict • PrestoGP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction for PrestoGP models — prestogp_predict"><meta property="og:description" content="After fitting a PrestoGP model, this method can be used to make predictions
on an independent test set (consisting of both new locations and new values
of the predictor variables)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PrestoGP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9029</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prediction for PrestoGP models</h1>
      
      <div class="d-none name"><code>prestogp_predict.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>After fitting a PrestoGP model, this method can be used to make predictions
on an independent test set (consisting of both new locations and new values
of the predictor variables).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prestogp_predict</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  X <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  locs <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  m <span class="op">=</span> <span class="st">"numeric"</span>,</span>
<span>  ordering.pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obspred"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  pred.cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independent"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  return.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"meanvar"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for VecchiaModel</span></span>
<span><span class="fu">prestogp_predict</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  X <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  locs <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordering.pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obspred"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  pred.cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independent"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  return.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"meanvar"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FullModel</span></span>
<span><span class="fu">prestogp_predict</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  X <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  locs <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordering.pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obspred"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  pred.cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independent"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  return.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"meanvar"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for MultivariateVecchiaModel</span></span>
<span><span class="fu">prestogp_predict</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  X <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  locs <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordering.pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obspred"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  pred.cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independent"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>  return.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"meanvar"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>A PrestoGP model object obtained after running
<code>link{prestogp_fit}</code>.</p></dd>


<dt>X</dt>
<dd><p>The values of the predictor variable(s) for which prediction will
be performed. Should be a matrix for univariate models or a list for
multivariate models.</p></dd>


<dt>locs</dt>
<dd><p>The locations where prediction will be performed. Should be a
matrix for univariate models or a list for multivariate models.</p></dd>


<dt>m</dt>
<dd><p>The number of neighbors to condition on. If not specified, it will
default to the value of m used to fit the model.</p></dd>


<dt>ordering.pred</dt>
<dd><p>Should "obspred" or "general" ordering be used for
prediction? See <code><a href="https://rdrr.io/pkg/GPvecchia/man/vecchia_specify.html" class="external-link">vecchia_specify</a></code> or
<code><a href="vecchia_Mspecify.html">vecchia_Mspecify</a></code>. Defaults to "obspred".</p></dd>


<dt>pred.cond</dt>
<dd><p>Should prediction conditioning be "general" or
"indepedent"? See <code><a href="https://rdrr.io/pkg/GPvecchia/man/vecchia_specify.html" class="external-link">vecchia_specify</a></code> or
<code><a href="vecchia_Mspecify.html">vecchia_Mspecify</a></code>. Defaults to "independent".</p></dd>


<dt>return.values</dt>
<dd><p>Values that should be returned. Possible values
include "mean" and "meanvar". See
<code><a href="https://rdrr.io/pkg/GPvecchia/man/vecchia_prediction.html" class="external-link">vecchia_prediction</a></code> or
<code><a href="vecchia_Mprediction.html">vecchia_Mprediction</a></code>. Defaults to "mean".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing the estimated mean values and (if requested)
standard deviations for the predictions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is important to note that the variance estimates produced by
this function assume that the Matern covariance parameters are fixed and
known. It does not consider any variance resulting from estimating the
covariance parameters or the regression coefficients in PrestoGP models.
These variance estimates will be anticonservative in such cases (and a
warning will be returned when these estimates are calculated).</p>
<p>Prediction is currently not implemented for full models. This function
will return an error if it is applied to a full model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Katzfuss, M., and Guinness, J. "A general framework for Vecchia
approximations of Gaussian processes", Statistical Science (2021)
36(1):124-141.</p></li>
<li><p>Katzfuss, M., Guinness, J., Gong, W. and Zilber, D. "Vecchia
approximations of Gaussian-process predictions", Journal of Agricultural,
Biological and Environmental Statistics (2020) 25:383-414.</p></li>
<li><p>Messier, K.P. and Katzfuss, M. "Scalable penalized spatiotemporal
land-use regression for ground-level nitrogen dioxide", The Annals of
Applied Statistics (2021) 15(2):688-710.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PrestoGPModel-class.html">PrestoGPModel-class</a></code>,<code><a href="prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></code>,
<code><a href="https://rdrr.io/pkg/GPvecchia/man/vecchia_prediction.html" class="external-link">vecchia_prediction</a></code>,
<code><a href="vecchia_Mprediction.html">vecchia_Mprediction</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># remove rows with NA's</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>                   <span class="co"># predict moisture content</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create training and test sets</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">otr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">otr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="va">otst</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">otr</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the model on the training set</span></span></span>
<span class="r-in"><span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu"><a href="prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span><span class="op">[</span><span class="va">otr</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span><span class="va">otr</span>,<span class="op">]</span>, <span class="va">locs</span><span class="op">[</span><span class="va">otr</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform predictions on the test set</span></span></span>
<span class="r-in"><span><span class="va">soil.yhat</span> <span class="op">&lt;-</span> <span class="fu">prestogp_predict</span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">X</span><span class="op">[</span><span class="va">otst</span>,<span class="op">]</span>, <span class="va">locs</span><span class="op">[</span><span class="va">otst</span>,<span class="op">]</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Eric Bair, Brian Kidd, Eric Wimberley, Deepak Mav, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

