<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Simultaneous variable seletion and estimation of LUR models with spatiotemporally correlated errors that is scalable for big data.">
<title>Penalized Regression for Spatio-Temporal Outcomes via Gaussian Processes • PrestoGP</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Penalized Regression for Spatio-Temporal Outcomes via Gaussian Processes">
<meta property="og:description" content="Simultaneous variable seletion and estimation of LUR models with spatiotemporally correlated errors that is scalable for big data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">PrestoGP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9031</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level2">
<h2 id="prestogp-penalized-regression-on-spatio-temporal-outcomes-using-gaussian-process">
<strong>PrestoGP</strong>: <strong>P</strong>enalized <strong>Re</strong>gression on <strong>S</strong>patio-<strong>T</strong>emporal <strong>O</strong>utcomes using <strong>G</strong>aussian <strong>P</strong>rocess<a class="anchor" aria-label="anchor" href="#prestogp-penalized-regression-on-spatio-temporal-outcomes-using-gaussian-process"></a>
</h2>
<p><a href="https://github.com/NIEHS/PrestoGP/actions/workflows/check-standard.yaml" class="external-link"><img src="https://github.com/NIEHS/PrestoGP/actions/workflows/check-standard.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://github.com/NIEHS/PrestoGP/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/NIEHS/PrestoGP/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage-local"></a> <a href="https://github.com/NIEHS/PrestoGP/actions" class="external-link"><img src="https://NIEHS.github.io/PrestoGP/badges/coverage.svg" alt="cov"></a> <a href="https://github.com/NIEHS/PrestoGP/actions/workflows/lint.yaml" class="external-link"><img src="https://github.com/NIEHS/PrestoGP/actions/workflows/lint.yaml/badge.svg" alt="lint"></a> <a href="https://github.com/NIEHS/PrestoGP/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/NIEHS/PrestoGP/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a> <a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></p>
<p><img src="reference/figures/prestoGP-logo.png" alt="PrestoGP Logo" width="33%"></p>
</div>
<div class="section level1">
<div class="page-header"><h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1></div>
<p>PrestoGP is an R package for scalable penalized regression on spatio-temporal outcomes using Gaussian processes. The package includes the methods described in the paper “Scalable penalized spatiotemporal land-use regression for ground-level nitrogen dioxide” by Messier and Katzfuss (2020). The package is designed to handle big data and is useful for large-scale geospatial exposure assessment and geophysical modeling. PrestoGP expands the methods in Messier and Katzfuss (2020) to include the following important feature:</p>
<ol style="list-style-type: decimal">
<li><p>Multivariate spatiotemporal outcomes using multivariate Matern Gaussian process. The method is described in the paper “A valid Matérn class of cross-covariance functions for multivariate random fields with any number of components” by Apanasovich, Genton, and Sun (2012).</p></li>
<li><p>Simultaneous variable selection and estimation of the fixed effects (i.e. land-use regression variables) and the spatiotemporal random effects. The method is described in the paper “Scalable penalized spatiotemporal land-use regression for ground-level nitrogen dioxide” by Messier and Katzfuss (2020).</p></li>
<li><p>Imputation of missing outcome data, including outcome data that is missing due to limit of detection effects.</p></li>
<li><p>And as always, scalability of the Gaussian Process via the General Vecchia approximation as described in the paper “A general framework for Vecchia approximations of Gaussian processes” by Katzfuss and Guinness (2021).</p></li>
</ol>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>You can install the development version of PrestoGP from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"NIEHS/PrestoGP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="usage-and-examples">Usage and Examples<a class="anchor" aria-label="anchor" href="#usage-and-examples"></a>
</h1>
<div class="section level2">
<h2 id="data-preprocessing">Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span></span>
<span><span class="va">soil</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># remove rows with NA's</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>                   <span class="co"># predict moisture content</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vecchia-model">Vecchia Model<a class="anchor" aria-label="anchor" href="#vecchia-model"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">soil.vm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="impute-missing-ys">Impute Missing y’s<a class="anchor" aria-label="anchor" href="#impute-missing-ys"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">y.miss</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span><span class="va">y.miss</span><span class="op">[</span><span class="va">miss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span>, impute.y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="impute-ys-missing-due-to-limit-of-detection">Impute y’s Missing Due to Limit of Detection<a class="anchor" aria-label="anchor" href="#impute-ys-missing-due-to-limit-of-detection"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soil.lod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">y.lod</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span><span class="va">y.lod</span><span class="op">[</span><span class="va">y.lod</span> <span class="op">&lt;=</span> <span class="va">soil.lod</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">soil.vm3</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">soil.vm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span>, impute.y <span class="op">=</span> <span class="cn">TRUE</span>, lod <span class="op">=</span> <span class="va">soil.lod</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="full-model">Full Model<a class="anchor" aria-label="anchor" href="#full-model"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soil.fm</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"FullModel"</span><span class="op">)</span></span>
<span><span class="va">soil.fm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.fm</span>, <span class="va">y</span>, <span class="va">X</span>, <span class="va">locs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multivariate-model">Multivariate Model<a class="anchor" aria-label="anchor" href="#multivariate-model"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ym</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>             <span class="co"># predict two nitrogen concentration levels</span></span>
<span><span class="va">ym</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">soil</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span></span>
<span><span class="va">Xm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Xm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Xm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">locsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">locsm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">locsm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">locs</span></span>
<span></span>
<span><span class="va">soil.mvm</span> <span class="op">&lt;-</span>  <span class="fu">new</span><span class="op">(</span><span class="st">"MultivariateVecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">soil.mvm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.mvm</span>, <span class="va">ym</span>, <span class="va">Xm</span>, <span class="va">locsm</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="spaceelevation-model">Space/Elevation Model<a class="anchor" aria-label="anchor" href="#spaceelevation-model"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil250</span>, package<span class="op">=</span><span class="st">"geoR"</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">soil250</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span>               <span class="co"># predict pH level</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil250</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># columns 1+2 are location coordinates; column 3 is elevation</span></span>
<span><span class="va">locs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">soil250</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># fit separate scale parameters for location and elevation</span></span>
<span><span class="va">soil.vm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm2</span>, <span class="va">y2</span>, <span class="va">X2</span>, <span class="va">locs2</span>, scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="test-set-prediction">Test Set Prediction<a class="anchor" aria-label="anchor" href="#test-set-prediction"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create training and test sets</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">otr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">otr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">otst</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">otr</span></span>
<span>     </span>
<span><span class="co"># Fit the model on the training set</span></span>
<span><span class="va">soil.vmp</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"VecchiaModel"</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">soil.vmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_fit-PrestoGPModel-method.html">prestogp_fit</a></span><span class="op">(</span><span class="va">soil.vm</span>, <span class="va">y</span><span class="op">[</span><span class="va">otr</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span><span class="va">otr</span>,<span class="op">]</span>, <span class="va">locs</span><span class="op">[</span><span class="va">otr</span>,<span class="op">]</span><span class="op">)</span></span>
<span>     </span>
<span><span class="co"># Perform predictions on the test set</span></span>
<span><span class="va">soil.yhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prestogp_predict.html">prestogp_predict</a></span><span class="op">(</span><span class="va">soil.vmp</span>, <span class="va">X</span><span class="op">[</span><span class="va">otst</span>,<span class="op">]</span>, <span class="va">locs</span><span class="op">[</span><span class="va">otst</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="work-in-progress">Work In Progress<a class="anchor" aria-label="anchor" href="#work-in-progress"></a>
</h1>
<p>This package is currently under development. Please report any issues on the <a href="https://github.com/NIEHS/PrestoGP/issues" class="external-link">Issues page</a></p>
<div class="section level3">
<h3 id="multivariate-and-censored-geospatial-models-for-external-exposomics-of-data-sparse-chemicals-united-states-chlorotriazine-groundwater-distributions-from-1990-2022">Multivariate and Censored Geospatial Models For External Exposomics of Data-Sparse Chemicals: United States Chlorotriazine Groundwater Distributions from 1990-2022<a class="anchor" aria-label="anchor" href="#multivariate-and-censored-geospatial-models-for-external-exposomics-of-data-sparse-chemicals-united-states-chlorotriazine-groundwater-distributions-from-1990-2022"></a>
</h3>
<p>The manuscript is in progress and expected to be submitted soon. Please check back for updates or contact Kyle Messier for more information.</p>
</div>
<div class="section level3">
<h3 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h3>
<ul>
<li>Kyle P Messier<sup>1,2</sup>
</li>
<li>Insang Song<sup>1,2</sup>
</li>
<li>Matt W Wheeler<sup>2</sup>
</li>
<li>Myeongjon Kang<sup>3</sup>
</li>
<li>Matthias Katzfuss<sup>3</sup>
</li>
<li>Ruchir R Shah<sup>4</sup>
</li>
<li>Deepak Mav<sup>4</sup>
</li>
<li>Brian Kidd<sup>4</sup>
</li>
<li>Eric Bair<sup>4</sup>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="affiliations">Affiliations<a class="anchor" aria-label="anchor" href="#affiliations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>National Institute of Environmental Health Sciences, Division of the National Toxicology Program, Predictive Toxicology Branch</li>
<li>National Institute of Environmental Health Sciences, Division of Intramural Research, Biostatistics and Computational Biology Branch</li>
<li>University of Wisconsin, Department of Statistics</li>
<li>Sciome, LLC</li>
</ol>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing PrestoGP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Eric Bair <br><small class="roles"> Author, maintainer </small>  </li>
<li>Brian Kidd <br><small class="roles"> Author </small>  </li>
<li>Eric Wimberley <br><small class="roles"> Author </small>  </li>
<li>Deepak Mav <br><small class="roles"> Author </small>  </li>
<li>Kyle Messier <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Bair, Brian Kidd, Eric Wimberley, Deepak Mav, Kyle Messier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
